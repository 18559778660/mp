(window.webpackJsonpMp=window.webpackJsonpMp||[]).push([[197],{1044:function(t,e,n){var a=n(1982);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(2).default)("25bf219a",a,!0,{})},1981:function(t,e,n){"use strict";var a=n(1044);n.n(a).a},1982:function(t,e,n){(t.exports=n(3)(!1)).push([t.i,".sub-app-container[data-v-6614b61a] {\n  position: relative;\n}\n.sub-app-container .test-panel-icon[data-v-6614b61a] {\n  position: fixed;\n  bottom: 32px;\n  right: 32px;\n  background-color: var(--weuiDesktop_BG_emBgColor);\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.15);\n}\n.sub-app-container .test-panel-icon[data-v-6614b61a]:hover:before,\n.sub-app-container .test-panel-icon[data-v-6614b61a]:active:before {\n  display: block;\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: inherit;\n  background-color: var(--weuiDesktop_FG_Text_lightColor_disabled);\n}\n.sub-app-container .panel-container[data-v-6614b61a] {\n  padding: 0 32px;\n}\n.sub-app-container .panel-container .panel-item[data-v-6614b61a] {\n  display: flex;\n  align-items: center;\n  margin-top: 10px;\n}\n.sub-app-container .panel-container .panel-item .item-label[data-v-6614b61a] {\n  margin-right: 10px;\n  font-weight: bold;\n  width: 80px;\n  display: flex;\n  align-items: center;\n}\n.sub-app-container .panel-container .panel-item .item-label[data-v-6614b61a] .weui-desktop-popover__target {\n  display: flex;\n  align-items: center;\n}\n",""])},3312:function(t,e,n){"use strict";n.r(e);var a=n(1),i=n(6),s=n.n(i),o=n(10),r=n(78),c=n(11),l=n(73),u=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],a=!0,i=!1,s=void 0;try{for(var o,r=t[Symbol.iterator]();!(a=(o=r.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){i=!0,s=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(t,e,n,a){return new(n||(n=Promise))((function(i,s){function o(t){try{c(a.next(t))}catch(t){s(t)}}function r(t){try{c(a.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,r)}c((a=a.apply(t,e||[])).next())}))},m={moduleName:"",name:"",url:"",mainBasePath:"",appBasePath:"",branch:"",commitId:""},h=a.a.extend({components:{WujieSubApp:r.b},data:function(){return Object.assign(Object.assign(Object.assign({},m),window.__INITIAL_STATE__.wujieConfig),{isLoaded:"object"===p(window.__INITIAL_STATE__.wujieConfig),attrs:{src:"https://mp.weixin.qq.com/wxamp/kf/client/static/wujie/index.html"},isWujieTestEnv:!1,isShowTestPanel:!1,branch:"",targetModule:"",targetModuleInfo:m,branchList:[],moduleList:[],plugins:[{jsIgnores:[/map.qq.com/]}]})},methods:Object.assign(Object.assign({},Object(o.e)(["SET_TOPTIPS"])),{successT:function(t){this.SET_TOPTIPS({type:"success",show:!0,msg:t},{root:!0})},errorT:function(t){this.SET_TOPTIPS({type:"error",show:!0,msg:t},{root:!0})},showTestPanel:function(){this.isShowTestPanel=!0},onBranchChange:function(){l.a.set("wujie-"+this.targetModule,this.branch),this.successT(this.$gettext("切换成功，正在刷新页面，请稍等")),window.location.reload()},onModuleChange:function(){var t=this,e=this.routeItems.find((function(e){return e.moduleName===t.targetModule}));this.targetModuleInfo=e||m,this.branch=(null==e?void 0:e.branch)||"",this.fetchBranchList()},initPanel:function(){return d(this,void 0,void 0,s.a.mark((function t(){var e,n,a,i,o=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.targetModule=this.moduleName,t.next=3,Promise.all([this.fetchBranchList(),c.a.get("/wujie/getTestEnvConfJson",{businessType:"WxampNodeSubAppConfigCenter"})]);case 3:e=t.sent,n=u(e,2),n[0],a=n[1],this.routeItems=a.conf.routeItems||[],i=this.routeItems.find((function(t){return t.moduleName===o.targetModule})),this.targetModuleInfo=i||m,this.branch=l.a.get("wujie-"+this.moduleName)||(null==i?void 0:i.branch)||"",this.moduleList=(a.conf.routeItems||[]).map((function(t){return{label:t.moduleName,value:t.moduleName}}));case 12:case"end":return t.stop()}}),t,this)})))},fetchBranchList:function(){return d(this,void 0,void 0,s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.get("/wujie/getSeparateKeyList",{businessType:this.targetModule});case 2:e=t.sent,this.branchList=[{label:this.$gettext("默认"),value:""}].concat((e.keyList||[]).map((function(t){return{label:t.key,value:t.key}})));case 4:case"end":return t.stop()}}),t,this)})))}}),computed:Object.assign({},Object(o.f)(["userInfo"])),created:function(){var t=this;"string"==typeof window.__INITIAL_STATE__.wujieConfig?c.a.get("/wujie/getCenterConfJson",{path:this.$router.history.current.path}).then((function(e){console.log("--getCenterConfJson res--",e),0===e.ret&&"object"===p(e.conf)&&(window.__INITIAL_STATE__.wujieConfig=e.conf,Object.keys(e.conf).forEach((function(n){t[n]=e.conf[n]}))),t.isLoaded=!0})).catch((function(e){console.log("--getCenterConfJson error--",e),t.isLoaded=!0})):this.isLoaded=!0;var e=this.$route.query.wujieTestEnv;Number(e)>0&&this.plugins.push({cssIgnores:[new RegExp("mp.weixin.qq.com"+window.__INITIAL_STATE__.wujieConfig.url+"(?!/static/css/web_client-entry_ts.chunk.css)")]})},mounted:function(){return d(this,void 0,void 0,s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.$route.query.wujieTestEnv,this.isWujieTestEnv=Number(e)>0||Number(this.userInfo.hostRole)>0,!this.isWujieTestEnv){t.next=5;break}return t.next=5,this.initPanel();case 5:case"end":return t.stop()}}),t,this)})))}}),f=(n(1981),n(5)),b=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isLoaded?n("div",{staticClass:"sub-app-container"},[n("WujieSubApp",{attrs:{width:"100%",height:"100%",name:t.name,moduleName:t.moduleName,mainBasePath:t.mainBasePath,appBasePath:t.appBasePath,attrs:t.attrs,sync:!0,url:t.addToken(t.url),plugins:t.plugins,statics:t.statics,commitId:t.commitId}}),t.isWujieTestEnv?n("div",{staticClass:"test-panel-icon",on:{click:t.showTestPanel}},[n("mp-icon",{attrs:{icon:"setting",color:"#fff"}})],1):t._e(),t.isWujieTestEnv?n("mp-dialog",{attrs:{value:t.isShowTestPanel,title:t.$gettext("微前端测试小面板"),width:600,"mask-closable":!0},on:{close:function(e){t.isShowTestPanel=!1}}},[n("div",{staticClass:"panel-container"},[n("mp-msg",{attrs:{icon:"warn",size:"mini",mode:"gray"}},[n("translate",[t._v("只有在链接上带有wujieTestEnv=1或处于测试环境机器情况才才会出现该面板，如果其他情况展示请检查")])],1),n("mp-msg",{attrs:{icon:"info",size:"mini",mode:"gray"}},[n("translate",[t._v("可以通过此面板来调整测试环境下不同模块的分支情况，如需调整现网配置需要到配置平台进行操作")]),t._v("，\n        "),n("a",{attrs:{href:"http://p6n.woa.com/mmbizwxampsubappconfig",target:"_blank"}},[t._v("http://p6n.woa.com/mmbizwxampsubappconfig")])],1),n("div",{staticClass:"panel-item"},[n("span",{staticClass:"item-label"},[n("translate",[t._v("模块名")]),n("mp-popover",{attrs:{trigger:"hover"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("模块详情")]),n("div",{staticClass:"panel-item"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"item-label"},[t._v("模块名")]),n("p",[t._v(t._s(t.targetModuleInfo.moduleName))])]),n("div",{staticClass:"panel-item"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"item-label"},[t._v("子应用名称")]),n("p",[t._v(t._s(t.targetModuleInfo.name))])]),n("div",{staticClass:"panel-item"},[n("span",{staticClass:"item-label"},[t._v("url")]),n("p",[t._v(t._s(t.targetModuleInfo.url))])]),n("div",{staticClass:"panel-item"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"item-label"},[t._v("主basePath")]),n("p",[t._v(t._s(t.targetModuleInfo.mainBasePath))])]),n("div",{staticClass:"panel-item"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"item-label"},[t._v("子basePath")]),n("p",[t._v(t._s(t.targetModuleInfo.appBasePath))])]),n("div",{staticClass:"panel-item"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"item-label"},[t._v("分支")]),n("p",[t._v(t._s(t.targetModuleInfo.branch||t.$gettext("默认")))])])]),n("template",{slot:"target"},[n("mp-icon",{attrs:{icon:"tips",width:16,height:16}})],1)],2)],1),n("mp-dropdown",{staticStyle:{width:"400px"},attrs:{options:t.moduleList},on:{change:t.onModuleChange},model:{value:t.targetModule,callback:function(e){t.targetModule=e},expression:"targetModule"}})],1),n("div",{staticClass:"panel-item"},[n("span",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"item-label"},[t._v("分支")]),n("mp-dropdown",{staticStyle:{width:"400px"},attrs:{options:t.branchList},on:{change:t.onBranchChange},model:{value:t.branch,callback:function(e){t.branch=e},expression:"branch"}})],1)],1)]):t._e()],1):t._e()}),[],!1,null,"6614b61a",null).exports,v=a.a.extend({name:"subApp",components:{MpWujieSubApp:b},data:function(){return{}}}),g=Object(f.a)(v,(function(){var t=this.$createElement;return(this._self._c||t)("MpWujieSubApp")}),[],!1,null,null,null);e.default=g.exports}}]);